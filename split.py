import pandas as pd
import csv

cols = ['stnam','fipst','leaid','leanm10','ncessch','schnam10','ALL_MTH00numvalid_1011','ALL_MTH00pctprof_1011','MAM_MTH00numvalid_1011','MAM_MTH00pctprof_1011','MAS_MTH00numvalid_1011','MAS_MTH00pctprof_1011','MBL_MTH00numvalid_1011','MBL_MTH00pctprof_1011','MHI_MTH00numvalid_1011','MHI_MTH00pctprof_1011','MTR_MTH00numvalid_1011','MTR_MTH00pctprof_1011','MWH_MTH00numvalid_1011','MWH_MTH00pctprof_1011','F_MTH00numvalid_1011','F_MTH00pctprof_1011','M_MTH00numvalid_1011','M_MTH00pctprof_1011','CWD_MTH00numvalid_1011','CWD_MTH00pctprof_1011','ECD_MTH00numvalid_1011','ECD_MTH00pctprof_1011','LEP_MTH00numvalid_1011','LEP_MTH00pctprof_1011','HOM_MTH00numvalid_1011','HOM_MTH00pctprof_1011','MIG_MTH00numvalid_1011','MIG_MTH00pctprof_1011','ALL_MTH03numvalid_1011','ALL_MTH03pctprof_1011','ALL_MTH04numvalid_1011','ALL_MTH04pctprof_1011','ALL_MTH05numvalid_1011','ALL_MTH05pctprof_1011','ALL_MTH06numvalid_1011','ALL_MTH06pctprof_1011','ALL_MTH07numvalid_1011','ALL_MTH07pctprof_1011','ALL_MTH08numvalid_1011','ALL_MTH08pctprof_1011','ALL_MTHHSnumvalid_1011','ALL_MTHHSpctprof_1011','MAM_MTH03numvalid_1011','MAM_MTH03pctprof_1011','MAM_MTH04numvalid_1011','MAM_MTH04pctprof_1011','MAM_MTH05numvalid_1011','MAM_MTH05pctprof_1011','MAM_MTH06numvalid_1011','MAM_MTH06pctprof_1011','MAM_MTH07numvalid_1011','MAM_MTH07pctprof_1011','MAM_MTH08numvalid_1011','MAM_MTH08pctprof_1011','MAM_MTHHSnumvalid_1011','MAM_MTHHSpctprof_1011','MAS_MTH03numvalid_1011','MAS_MTH03pctprof_1011','MAS_MTH04numvalid_1011','MAS_MTH04pctprof_1011','MAS_MTH05numvalid_1011','MAS_MTH05pctprof_1011','MAS_MTH06numvalid_1011','MAS_MTH06pctprof_1011','MAS_MTH07numvalid_1011','MAS_MTH07pctprof_1011','MAS_MTH08numvalid_1011','MAS_MTH08pctprof_1011','MAS_MTHHSnumvalid_1011','MAS_MTHHSpctprof_1011','MBL_MTH03numvalid_1011','MBL_MTH03pctprof_1011','MBL_MTH04numvalid_1011','MBL_MTH04pctprof_1011','MBL_MTH05numvalid_1011','MBL_MTH05pctprof_1011','MBL_MTH06numvalid_1011','MBL_MTH06pctprof_1011','MBL_MTH07numvalid_1011','MBL_MTH07pctprof_1011','MBL_MTH08numvalid_1011','MBL_MTH08pctprof_1011','MBL_MTHHSnumvalid_1011','MBL_MTHHSpctprof_1011','MHI_MTH03numvalid_1011','MHI_MTH03pctprof_1011','MHI_MTH04numvalid_1011','MHI_MTH04pctprof_1011','MHI_MTH05numvalid_1011','MHI_MTH05pctprof_1011','MHI_MTH06numvalid_1011','MHI_MTH06pctprof_1011','MHI_MTH07numvalid_1011','MHI_MTH07pctprof_1011','MHI_MTH08numvalid_1011','MHI_MTH08pctprof_1011','MHI_MTHHSnumvalid_1011','MHI_MTHHSpctprof_1011','MTR_MTH03numvalid_1011','MTR_MTH03pctprof_1011','MTR_MTH04numvalid_1011','MTR_MTH04pctprof_1011','MTR_MTH05numvalid_1011','MTR_MTH05pctprof_1011','MTR_MTH06numvalid_1011','MTR_MTH06pctprof_1011','MTR_MTH07numvalid_1011','MTR_MTH07pctprof_1011','MTR_MTH08numvalid_1011','MTR_MTH08pctprof_1011','MTR_MTHHSnumvalid_1011','MTR_MTHHSpctprof_1011','MWH_MTH03numvalid_1011','MWH_MTH03pctprof_1011','MWH_MTH04numvalid_1011','MWH_MTH04pctprof_1011','MWH_MTH05numvalid_1011','MWH_MTH05pctprof_1011','MWH_MTH06numvalid_1011','MWH_MTH06pctprof_1011','MWH_MTH07numvalid_1011','MWH_MTH07pctprof_1011','MWH_MTH08numvalid_1011','MWH_MTH08pctprof_1011','MWH_MTHHSnumvalid_1011','MWH_MTHHSpctprof_1011','F_MTH03numvalid_1011','F_MTH03pctprof_1011','F_MTH04numvalid_1011','F_MTH04pctprof_1011','F_MTH05numvalid_1011','F_MTH05pctprof_1011','F_MTH06numvalid_1011','F_MTH06pctprof_1011','F_MTH07numvalid_1011','F_MTH07pctprof_1011','F_MTH08numvalid_1011','F_MTH08pctprof_1011','F_MTHHSnumvalid_1011','F_MTHHSpctprof_1011','M_MTH03numvalid_1011','M_MTH03pctprof_1011','M_MTH04numvalid_1011','M_MTH04pctprof_1011','M_MTH05numvalid_1011','M_MTH05pctprof_1011','M_MTH06numvalid_1011','M_MTH06pctprof_1011','M_MTH07numvalid_1011','M_MTH07pctprof_1011','M_MTH08numvalid_1011','M_MTH08pctprof_1011','M_MTHHSnumvalid_1011','M_MTHHSpctprof_1011','CWD_MTH03numvalid_1011','CWD_MTH03pctprof_1011','CWD_MTH04numvalid_1011','CWD_MTH04pctprof_1011','CWD_MTH05numvalid_1011','CWD_MTH05pctprof_1011','CWD_MTH06numvalid_1011','CWD_MTH06pctprof_1011','CWD_MTH07numvalid_1011','CWD_MTH07pctprof_1011','CWD_MTH08numvalid_1011','CWD_MTH08pctprof_1011','CWD_MTHHSnumvalid_1011','CWD_MTHHSpctprof_1011','ECD_MTH03numvalid_1011','ECD_MTH03pctprof_1011','ECD_MTH04numvalid_1011','ECD_MTH04pctprof_1011','ECD_MTH05numvalid_1011','ECD_MTH05pctprof_1011','ECD_MTH06numvalid_1011','ECD_MTH06pctprof_1011','ECD_MTH07numvalid_1011','ECD_MTH07pctprof_1011','ECD_MTH08numvalid_1011','ECD_MTH08pctprof_1011','ECD_MTHHSnumvalid_1011','ECD_MTHHSpctprof_1011','LEP_MTH03numvalid_1011','LEP_MTH03pctprof_1011','LEP_MTH04numvalid_1011','LEP_MTH04pctprof_1011','LEP_MTH05numvalid_1011','LEP_MTH05pctprof_1011','LEP_MTH06numvalid_1011','LEP_MTH06pctprof_1011','LEP_MTH07numvalid_1011','LEP_MTH07pctprof_1011','LEP_MTH08numvalid_1011','LEP_MTH08pctprof_1011','LEP_MTHHSnumvalid_1011','LEP_MTHHSpctprof_1011','HOM_MTH03numvalid_1011','HOM_MTH03pctprof_1011','HOM_MTH04numvalid_1011','HOM_MTH04pctprof_1011','HOM_MTH05numvalid_1011','HOM_MTH05pctprof_1011','HOM_MTH06numvalid_1011','HOM_MTH06pctprof_1011','HOM_MTH07numvalid_1011','HOM_MTH07pctprof_1011','HOM_MTH08numvalid_1011','HOM_MTH08pctprof_1011','HOM_MTHHSnumvalid_1011','HOM_MTHHSpctprof_1011','MIG_MTH03numvalid_1011','MIG_MTH03pctprof_1011','MIG_MTH04numvalid_1011','MIG_MTH04pctprof_1011','MIG_MTH05numvalid_1011','MIG_MTH05pctprof_1011','MIG_MTH06numvalid_1011','MIG_MTH06pctprof_1011','MIG_MTH07numvalid_1011','MIG_MTH07pctprof_1011','MIG_MTH08numvalid_1011','MIG_MTH08pctprof_1011','MIG_MTHHSnumvalid_1011','MIG_MTHHSpctprof_1011']
all_states = pd.read_csv('/Users/esthenabarlow/Desktop/state_math.csv', skiprows=  1, names = cols)
all_states = all_states.sort('stnam')
states = all_states.groupby('stnam').groups
for state in states:
	state_df = all_states[all_states['stnam'] == state]
	state_df.to_csv('/Users/esthenabarlow/Desktop/state_achievement_data/math/'+state+'.csv', sep = ",", headers=True)
	print state + ", " + str(len(state_df))